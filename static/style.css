:root{
  --bg:#0b0b0b;
  --panel:#121212;
  --panel2:#1a1a1a;
  --stroke:#2b2b2b;
  --text:#e6e6e6;
  --muted:#9a9a9a;
  --link:#d0d0d0;
  --badge-bg:#0f0f0f;
}

*{ box-sizing:border-box; }
html, body{
  margin:0;
  padding:0;
}
body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", Arial;
  background: radial-gradient(1200px 600px at 15% 0%, #1a1a1a 0%, var(--bg) 55%);
  color:var(--text);
}

.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:8px 14px;
  border-radius:999px;
  border:1px solid transparent;
  font-weight:600;
  font-size:13px;
  letter-spacing:.2px;
  cursor:pointer;
  background:rgba(255,255,255,.04);
  color:var(--text);
  transition:background .2s ease, box-shadow .2s ease, transform .15s ease;
}
.btn:hover{
  background:rgba(255,255,255,.08);
  transform:translateY(-1px);
}
.btn:active{
  transform:translateY(0);
}
.btn[disabled]{
  cursor:not-allowed;
  opacity:.55;
  transform:none;
}
.btn.is-busy{
  pointer-events:none;
}
.spinner{
  width:14px;
  height:14px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,.3);
  border-top-color:#fff;
  animation:spin .6s linear infinite;
  display:inline-block;
}
@keyframes spin{
  to{ transform:rotate(360deg); }
}
.btn-primary{
  background:linear-gradient(135deg,#5f5f5f,#9a9a9a);
  color:#111;
  border-color:rgba(200,200,200,.4);
  box-shadow:0 8px 20px rgba(180,180,180,.3);
}
.btn-primary:hover{
  box-shadow:0 10px 24px rgba(180,180,180,.4);
}
.btn-ghost{
  border-color:rgba(255,255,255,.12);
  background:rgba(255,255,255,.02);
  color:var(--text);
}
.btn-outline{
  border-color:#3a3a3a;
  background:transparent;
  color:var(--link);
}
.btn-danger{
  border-color:rgba(248,113,113,.6);
  background:rgba(248,113,113,.12);
  color:#fecaca;
}
.btn-danger:hover{
  background:rgba(248,113,113,.22);
  color:#fff;
  border-color:rgba(248,113,113,.9);
}
.btn-icon{
  width:36px;
  height:36px;
  padding:0;
  border-radius:50%;
  font-size:18px;
}
.btn-small{
  padding:5px 12px;
  font-size:12px;
}
.btn-label{
  display:flex;
  align-items:center;
  gap:6px;
}

.input{
  flex:1;
  min-width:140px;
  padding:8px 12px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:var(--panel2);
  color:var(--text);
  font-size:13px;
}

.modal-backdrop{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(5,8,15,.75);
  backdrop-filter:blur(4px);
  z-index:1000;
  display:none;
  align-items:center;
  justify-content:center;
  padding:18px;
  opacity:0;
  transition:opacity .2s ease;
}
.modal-backdrop.is-open{
  display:flex;
  opacity:1;
}
.modal-panel{
  background:linear-gradient(180deg, var(--panel2), var(--panel));
  border:1px solid var(--stroke);
  border-radius:18px;
  width:100%;
  max-width:460px;
  box-shadow:0 20px 45px rgba(0,0,0,.45);
  padding:20px 22px;
}
.modal-head{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  margin-bottom:12px;
}
.modal-head h3{
  margin:0;
}
.modal-subtitle{
  margin:2px 0 0;
  font-size:12px;
  color:var(--muted);
}
.modal-body{
  max-height:320px;
  overflow-y:auto;
  padding-right:6px;
  margin-bottom:12px;
}
.modal-actions{
  display:flex;
  gap:10px;
  margin-top:16px;
  flex-wrap:wrap;
}
.modal-hint{
  font-size:12px;
  color:var(--muted);
  margin-bottom:8px;
  display:flex;
  align-items:center;
  gap:6px;
}
.modal-form{
  background:rgba(0,0,0,.12);
  border:1px solid rgba(255,255,255,.05);
  border-radius:12px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.modal-form label{
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:.3px;
  color:var(--muted);
}
.modal-form-row{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}
.modal-help{
  font-size:12px;
  color:var(--muted);
  margin:0;
}
.input-lg{
  padding:10px 14px;
  border-radius:999px;
}

.case-list{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.case-loader{
  display:flex;
  align-items:center;
  gap:8px;
  color:var(--muted);
  font-size:12px;
}
.case-option{
  text-align:left;
  border-radius:14px;
  border:1px solid rgba(200,200,200,.14);
  background:rgba(200,200,200,.05);
  padding:10px 12px;
  color:var(--text);
  cursor:pointer;
  transition:border-color .2s ease, transform .15s ease, background .2s ease;
}
.case-option:hover{
  border-color:rgba(200,200,200,.5);
  background:rgba(200,200,200,.08);
  transform:translateY(-1px);
}
.case-option-row{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
}
.case-option-title{
  font-weight:700;
  font-size:14px;
}
.case-option-meta{
  font-size:12px;
  color:var(--muted);
  margin-top:2px;
}
.case-empty{
  text-align:center;
  color:var(--muted);
  padding:24px 12px;
  border-radius:12px;
  border:1px dashed rgba(147,164,189,.4);
}
.case-picker{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  align-items:center;
}
.case-picker select{
  min-width:220px;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--stroke);
  background:var(--panel2);
  color:var(--text);
}
.case-picker-help{
  margin:8px 0 0;
  font-size:12px;
  color:var(--muted);
}
.case-rename{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
  margin-top:10px;
}
.case-tag{
  align-self:flex-start;
  font-size:11px;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(200,200,200,.4);
  background:rgba(200,200,200,.12);
  text-transform:capitalize;
}
.case-tag-high{
  border-color:rgba(248,113,113,.5);
  background:rgba(248,113,113,.18);
  color:#fecaca;
}
.case-tag-low{
  border-color:rgba(52,211,153,.4);
  background:rgba(52,211,153,.14);
  color:#bbf7d0;
}
.case-tag-critical{
  border-color:rgba(248,113,113,.8);
  background:rgba(248,113,113,.25);
  color:#fee2e2;
}

a:not(.btn){ color:var(--link); text-decoration:none; }
a:not(.btn):hover{ text-decoration:underline; }

.topbar{
  position:sticky; top:0;
  display:flex; justify-content:space-between; align-items:center;
  padding:0 18px;
  height:52px;
  background:rgba(18,18,18,.96);
  border-bottom:1px solid var(--stroke);
  backdrop-filter: blur(8px);
}
.topbar-nav{
  display:flex;
  gap:14px;
  align-items:center;
  height:100%;
}
.topbar .link,
.topbar .brand{
  display:inline-flex;
  align-items:center;
  height:100%;
  line-height:1;
  padding:0;
}
.brand{ font-weight:800; letter-spacing:.2px; }
.container{ max-width:100%; margin:0 auto; padding:18px; width:100%; }
.container-full{ width:100vw; margin-left:calc(-50vw + 50%); padding-left:18px; padding-right:18px; }

h1{ margin:6px 0 4px; font-size:26px; }
.sub{ color:var(--muted); font-size:13px; }

.page-head{
  display:flex; align-items:flex-start; justify-content:space-between;
  gap:14px; margin-bottom:14px;
}
.page-head-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.card-body{
  padding:16px;
}
.kpi-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap:14px;
  margin-bottom:20px;
}
.kpi-card{
  padding:14px 16px;
  min-height:88px;
  border-radius:16px;
  border:1px solid var(--stroke);
  background:linear-gradient(180deg, rgba(255,255,255,.03), var(--panel));
  box-shadow: 0 8px 28px rgba(0,0,0,.25);
}
.kpi-card .kpi-label{ font-size:11px; text-transform:uppercase; letter-spacing:.8px; color:var(--muted); }
.kpi-card .kpi-value{ font-size:26px; font-weight:800; margin-top:6px; }
.section-grid{
  display:grid;
  grid-template-columns: repeat(12, minmax(0, 1fr));
  gap:16px;
}
.section-grid .card{ grid-column: span 12; }
.section-grid .panel-wide{ grid-column: span 7; }
.section-grid .panel-narrow{ grid-column: span 5; }
.chart-block{ margin-bottom:16px; }
.chart-title{ font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.6px; margin-bottom:8px; }
.chart-frame{
  border:1px solid rgba(255,255,255,.06);
  border-radius:14px;
  background:rgba(0,0,0,.25);
  padding:12px;
}
.chart-canvas{
  display:block;
  height:160px;
  width:100%;
  overflow:hidden;
}
.mini-chart{ width:100%; height:100%; color:#89b4ff; }
.mini-chart .axis{ stroke:rgba(255,255,255,.2); stroke-width:1; }
.mini-chart .last-point{ fill:#c7d2fe; }
.bars{ display:flex; align-items:flex-end; gap:6px; height:72px; width:100%; }
.bar{ display:flex; flex-direction:column; justify-content:flex-end; width:10px; gap:2px; }
.bar-a{ background:#4fd1c5; border-radius:6px 6px 2px 2px; }
.bar-b{ background:#667eea; border-radius:6px 6px 2px 2px; }
.activity-block{ margin-bottom:18px; }
.activity-title{ font-weight:700; margin-bottom:8px; }
.activity-list{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px; }
.activity-list li{ display:flex; gap:10px; align-items:center; }
.activity-list.ranked{ list-style:decimal; padding-left:18px; }
.badge.status-open{ background:rgba(90,200,140,.15); border-color:rgba(90,200,140,.45); }
.badge.status-monitoring{ background:rgba(90,140,200,.15); border-color:rgba(90,140,200,.45); }
.badge.status-closed{ background:rgba(200,200,200,.12); border-color:rgba(200,200,200,.35); }
.badge.status-false_positive{ background:rgba(255,180,80,.18); border-color:rgba(255,180,80,.45); }
.badge-accent{ background:rgba(140,120,255,.18); border-color:rgba(140,120,255,.45); }

.kpis{ display:flex; gap:10px; flex-wrap:wrap; }
.kpi{
  background:linear-gradient(180deg, var(--panel2), var(--panel));
  border:1px solid var(--stroke);
  border-radius:14px;
  padding:10px 12px;
  min-width:140px;
}
.kpi-label{ color:var(--muted); font-size:12px; }
.kpi-value{ font-size:22px; font-weight:800; margin-top:2px; }

.card{
  background:linear-gradient(180deg, var(--panel2), var(--panel));
  border:1px solid var(--stroke);
  border-radius:16px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  margin-bottom:14px;
}
.card-head{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 14px;
  border-bottom:1px solid var(--stroke);
}
.card-title{ font-weight:800; }
.card-sub{ color:var(--muted); font-size:12px; }

.actor-actions{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:20px;
  padding:18px;
}
.actor-actions__info{
  flex:1;
}
.actor-actions__eyebrow{
  text-transform:uppercase;
  font-size:11px;
  letter-spacing:.2px;
  color:var(--muted);
  margin-bottom:4px;
}
.actor-actions__title{
  font-weight:700;
  font-size:16px;
  margin-bottom:4px;
}
.actor-actions__subtitle{
  color:var(--muted);
  font-size:13px;
}
.actor-actions__buttons{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.campaign-card{
  margin-bottom:16px;
  background:linear-gradient(180deg,rgba(255,255,255,.02),var(--panel));
}
.campaign-body{
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.campaign-meta-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}
.reason-list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.reason-pill{
  padding:4px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.15);
  font-size:11px;
  background:rgba(255,255,255,.04);
}
.campaign-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.toast{
  position:fixed;
  top:90px;
  right:24px;
  background:rgba(15,23,42,.95);
  border:1px solid rgba(200,200,200,.3);
  border-radius:12px;
  padding:10px 16px;
  min-width:180px;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
  opacity:0;
  pointer-events:none;
  transform:translateY(-8px);
  transition:opacity .2s ease, transform .2s ease;
  font-size:13px;
}
.toast.is-visible{
  opacity:1;
  transform:translateY(0);
}
.toast[data-type="success"]{
  border-color:rgba(52,211,153,.4);
  color:#bbf7d0;
}
.toast[data-type="error"]{
  border-color:rgba(248,113,113,.5);
  color:#fecaca;
}

.table-wrap{ overflow-x:auto; overflow-y:visible; display:block; }
.table-toolbar{
  display:flex;
  gap:8px;
  align-items:center;
  flex-wrap:wrap;
  padding:8px 4px 10px;
}
.table{
  width:100%;
  border-collapse:collapse;
}
.table th, .table td{
  padding:8px 10px;
  border-bottom:1px solid rgba(60,60,60,.7);
  vertical-align:top;
  word-break:break-word;
  font-size:13px;
}
.table th{
  text-align:left;
  color:#d6d6d6;
  font-weight:700;
  font-size:12px;
  background: rgba(0,0,0,.15);
}
.table-sortable thead tr.header th{
  cursor:pointer;
  user-select:none;
  position:relative;
}
.table-sortable th[data-sort-dir="asc"]::after,
.table-sortable th[data-sort-dir="desc"]::after{
  font-size:10px;
  margin-left:6px;
  color:var(--muted);
}
.table-sortable th[data-sort-dir="asc"]::after{ content:"▲"; }
.table-sortable th[data-sort-dir="desc"]::after{ content:"▼"; }
.table-filters th{
  background: rgba(0,0,0,.08);
}
.table-filter{
  width:100%;
  padding:6px 8px;
  border-radius:8px;
  border:1px solid var(--stroke);
  background:var(--panel);
  color:var(--text);
  font-size:12px;
}
.table-filter::placeholder{ color:var(--muted); }
.table-filter:focus{
  outline:none;
  border-color:rgba(200,200,200,.5);
}
.table tr:hover td{ background: rgba(200,200,200,.06); }

.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
.muted{ color:var(--muted); }
.tag{
  display:inline-flex;
  align-items:center;
  padding:2px 10px;
  border-radius:999px;
  border:1px solid rgba(200,200,200,.4);
  font-size:12px;
  background:rgba(200,200,200,.12);
}
.tag-muted{
  border-color:rgba(255,255,255,.2);
  color:var(--muted);
}
.small-text{ font-size:12px; }
.tiny-text{ font-size:11px; color:var(--muted); }
.clip{ max-width:520px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.code-block{
  margin:8px 0 0;
  padding:10px 12px;
  border-radius:8px;
  background: rgba(0,0,0,.35);
  border:1px solid var(--stroke);
  color:var(--text);
  white-space:pre-wrap;
  font-size:12px;
}
.list{
  margin:8px 0 0;
  padding-left:18px;
}
.list li{
  margin:6px 0;
}

.badge{
  display:inline-flex; align-items:center; gap:6px;
  padding:3px 10px;
  border:1px solid #3a3a3a;
  border-radius:999px;
  background: var(--badge-bg);
  font-size:12px;
  margin-right:6px;
  white-space:nowrap;
}
.badge-warn{
  border-color:#5b3a3a;
  background: rgba(255,120,120,.08);
}

.pill{
  display:inline-block;
  padding:3px 10px;
  border-radius:999px;
  border:1px solid #3a3a3a;
  background: rgba(200,200,200,.08);
  font-weight:700;
  font-size:12px;
}

.flag{
  display:inline-block;
  margin-right:6px;
  font-size:16px;
  line-height:1;
  font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
}

.back{ display:inline-block; margin-bottom:8px; }

.grid-2{
  display:grid;
  grid-template-columns: 1.1fr 1.6fr;
  gap:14px;
}
.summary-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap:14px;
}
.form-row{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap:14px;
}
@media (max-width: 980px){
  .page-head{ align-items:flex-start; flex-direction:column; }
  .grid-2{ grid-template-columns:1fr; }
  .summary-grid, .form-row{ grid-template-columns:1fr; }
  .clip{ max-width:260px; }
  .kpi-grid{ grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
  .section-grid .card,
  .section-grid .panel-wide,
  .section-grid .panel-narrow{ grid-column: span 12; }
  .chart-canvas{ height:140px; }
}

.kv{
  display:grid;
  grid-template-columns: 120px 1fr;
  gap:8px 12px;
  padding:12px 14px;
}
.k{ color:var(--muted); }

.timeline{ padding:12px 14px; }
.evt{
  display:grid;
  grid-template-columns: 18px 1fr;
  gap:12px;
  padding:10px 0;
}
.evt-rail{ position:relative; display:flex; justify-content:center; }
.evt-dot{
  width:10px; height:10px; border-radius:50%;
  background:#bdbdbd;
  box-shadow: 0 0 0 4px rgba(200,200,200,.14);
  margin-top:7px;
}
.evt-line{
  position:absolute;
  top:18px; bottom:-12px;
  width:2px;
  background: rgba(200,200,200,.18);
}
.evt:last-child .evt-line{ display:none; }

.evt-top{
  display:flex; justify-content:space-between; align-items:center;
  gap:10px;
}
.evt-kind{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
.icon{ font-size:16px; }
.evt-ts{ font-size:12px; }
.evt-meta{ font-size:12px; margin-top:6px; }

.pre{
  margin-top:10px;
  background: rgba(0,0,0,.25);
  border:1px solid rgba(60,60,60,.9);
  border-radius:12px;
  padding:10px 12px;
  overflow:auto;
}

.evidence-section-title{
  margin:12px 0 6px;
  font-size:12px;
  letter-spacing:.3px;
  text-transform:uppercase;
  color:var(--muted);
}
.evidence-list{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.evidence-item{
  border:1px solid rgba(200,200,200,.08);
  border-radius:14px;
  padding:12px 14px;
  background:rgba(255,255,255,.02);
}
.evidence-item-head{
  display:flex;
  justify-content:space-between;
  gap:10px;
  align-items:flex-start;
}
.evidence-actions{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}
.evidence-title{
  font-weight:700;
  font-size:14px;
}
.evidence-meta{
  font-size:12px;
  color:var(--muted);
  margin-top:3px;
}
.evidence-body{
  margin-top:8px;
}
.evidence-note{
  margin-top:6px;
  font-size:12px;
  color:var(--muted);
}

.session-meta{
  display:flex;
  flex-direction:column;
  gap:14px;
  padding:18px;
}
.session-summary{
  display:flex;
  justify-content:space-between;
  gap:20px;
  flex-wrap:wrap;
}
.session-case-form{
  border-top:1px solid rgba(255,255,255,.08);
  padding-top:14px;
}
.step-actions{
  display:flex;
  align-items:center;
  gap:8px;
}

